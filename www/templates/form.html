<form name="{{dapa.api.currentForm.$id}}" class="flex-column between text-center h-center" ng-init="dapa.ui.formState = dapa.ui.formModel[dapa.api.currentForm.progress-1];

">
    <div class="flex-row between w100">
        <div class="text-left float-left">
            <button
                    ng-click="dapa.api.navigateForm('back')"
                    class="start button button-assertive button-clear button-icon icon ion-ios-arrow-back">
                Back
            </button>
        </div>
        <div class="text-right">
            <button ng-click="cancelForm = true" class="button button-clear button-assertive">Close</button>
        </div>
    </div>

    <div class="w90 "><h3 ng-class="{back: dapa.ui.back}">{{dapa.ui.formState.name}}</h3>

        <div ng-class="{back: dapa.ui.back}" class="text-left">
            <div ng-repeat="question in dapa.ui.formState.questions">
                <label ng-show="question.type === 'input'">
                    <div>
                        {{question.name | uppercase}}
                    </div>
                    <input type="{{question.subtype}}" ng-model="dapa.api.currentForm[question.id]"
                           placeholder="{{question.placeholder}}">
                </label>

                <div ng-show="question.type === 'bool'">
                    <div>
                        <b>{{question.name | uppercase}}</b>
                    </div>
                    <h4 ng-click="dapa.api.currentForm[question.id] = key"
                        ng-repeat="(key, answer) in question.answers">
                        <div class="icon-stack float-left">
                            <a class="ion-ios7-circle-outline "></a>
                            <a ng-show="dapa.api.currentForm[question.id] === key" class="ion-checkmark"></a>

                        </div>
                        {{answer}}
                    </h4>

                    <!-- <label ng-repeat="(key, answer) in question.answers" for="{{$parent.question.id}}-{{key}}"><input id="{{$parent.question.id}}-{{key}}" type="{{$parent.question.subtype}}" ng-model="dapa.api.currentForm[question.id]" placeholder="{{$parent.question.placeholder}}" value="{{key}}"> {{answer}}
                         <br></label>-->

                </div>
            </div>
        </div>
    </div>

    <div class="w80 text-left">
        <b>FORM COMPLETENESS: {{dapa.ui.formState.complete}}%</b>

        <div>
            <progress max="100" value="{{dapa.ui.formState.complete}}"></progress>
        </div>
        <button
                class="w100 button button-assertive primary"
                ng-click="dapa.ui.formState.complete === 100 ? confirmation = true : dapa.api.navigateForm()">
            Continue
        </button>
        <div>
            <br>
        </div>
    </div>
</form>


<div ng-show="cancelForm" class="modal-dark w100 h100">
    <div class="flex-column center-container center">
        <div class="flex-column welcome text-center h-center w80 h50 modal center">
            <div class="w80">
                <h3>Want to save your progress</h3>
                <br>

                <div>Save your form now and you'll be able to get back to it later from where you left off. If you
                    choose not to save it, your progress will be lost.
                </div>
                <br>

                <div class="flex-row around w100">
                    <button type="button" class="button button-light primary flex"
                            ng-click="dapa.ui.back = true; dapa.api.go('dapa.forms'); ">
                        Discard
                    </button>
                    <button type="button" class="button button-assertive primary flex"
                            ng-click="dapa.ui.back = true; dapa.api.updateForm(dapa.api.currentForm.$id, dapa.api.currentForm); dapa.api.go('dapa.forms'); ">
                        Save
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div ng-show="confirmation" class="modal-dark w100 h100">
    <div class="flex-column center-container center">
        <div class="flex-column welcome text-center h-center w80 h50 modal center">
            <div class="w80">
                <h3>Form submitted</h3>
                <h2>
                        00000000
                </h2>
                <p>{{'your confirmation number' | uppercase}}</p>
                <hr>
                <p>Thanks for submitting the form! One of our representatives will be in touch shortly. Check your inbox for a confirmation email, too!</p>
                <button type="button" class="button button-assertive button-block primary w100"
                        ng-click="dapa.ui.back = false; dapa.api.go('dapa.forms'); ">
                    Got it!
                </button>
            </div>
        </div>
    </div>
</div>